<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Relatório de Desempenho - Nexo</title>
    <style>
        body {
            font-family: 'Helvetica', 'Arial', sans-serif;
            color: #333;
        }
        h1 {
            color: #00bcd4; 
            border-bottom: 2px solid #00bcd4;
        }
        h2 {
            color: #1a1c22; 
        }
        .section {
            margin-bottom: 30px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Relatório de Desempenho - Nexo</h1>
        <p>Gerado em: {% now "d/m/Y H:i" %}</p>
    </div>

    <div class="section">
        <h2>1. Informações do Paciente</h2>
        <table>
            <tr>
                <th>Nome</th>
                <td>{{ usuario.nome_completo }}</td>
            </tr>
            <tr>
                <th>Nome Social</th>
                <td>{{ usuario.nome_social|default:"N/A" }}</td>
            </tr>
            <tr>
                <th>Email</th>
                <td>{{ usuario.email }}</td>
            </tr>
            <tr>
                <th>CPF</th>
                <td>{{ usuario.cpf }}</td>
            </tr>
            <tr>
                <th>Data de Nascimento</th>
                <td>{{ usuario.data_nascimento }}</td>
            </tr>
        </table>
    </div>

    <div class="section">
        <h2>2. Informações Médicas (do Perfil)</h2>
        <table>
            <tr>
                <th>Grau do TEA</th>
                <td>{{ perfil.get_grau_tea_display }}</td> </tr>
            <tr>
                <th>Peso</th>
                <td>{{ perfil.peso }} kg</td>
            </tr>
            <tr>
                <th>Altura</th>
                <td>{{ perfil.altura }} m</td>
            </tr>
             <tr>
                <th>Tipo Sanguíneo</th>
                <td>{{ perfil.get_tipo_sanguineo_display }}</td>
            </tr>
            <tr>
                <th>Comorbidades</th>
                <td>{{ perfil.comorbidades|default:"Nenhuma" }}</td>
            </tr>
            <tr>
                <th>Alergias</th>
                <td>{{ perfil.alergias|default:"Nenhuma" }}</td>
            </tr>
        </table>
    </div>
    
    <div class="section">
        <h2>3. Estatísticas de Uso (Básico)</h2>
        <p>Total de dias com registro no calendário: <strong>{{ total_dias_registrados }}</strong></p>
        
        <h3>Últimos Registros no Calendário</h3>
        {% for registro in registros %}
            <p>
                <strong>{{ registro.data_selecionada }}:</strong> 
                {{ registro.resumo_diario|default:"Sem resumo." }}
            </p>
        {% empty %}
            <p>Nenhum registro no calendário ainda.</p>
        {% endfor %}
    </div>

</body>
</html>